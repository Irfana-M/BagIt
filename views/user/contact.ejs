<%-include("../../views/partials/user/header")%>

<!-- Start Banner Area -->
<section class="banner-area organic-breadcrumb">
  <div class="container">
    <div
      class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end"
    >
      <div class="col-first">
        <h1>Contact Us</h1>
        <nav class="d-flex align-items-center">
          <a href="index.html">Home<span class="lnr lnr-arrow-right"></span></a>
          <a href="category.html">Contact</a>
        </nav>
      </div>
    </div>
  </div>
</section>
<!-- End Banner Area -->

<!--================Contact Area =================-->
<section class="contact_area section_gap_bottom">
  <div class="container">
    <div
      id="mapBox"
      class="mapBox"
      data-lat="10.9048"
      data-lon="75.9234"
      data-zoom="15"
      data-info="BAG IT, Tirur, Malappuram, Kerala, India."
      data-mlat="10.9048"
      data-mlon="75.9234"
    ></div>
    <div class="row">
      <div class="col-lg-3">
        <div class="contact_info">
          <div class="info_item">
            <i class="lnr lnr-home"></i>
            <h6>BAG IT Shopping</h6>
            <p>Tirur</p>
          </div>
          <div class="info_item">
            <i class="lnr lnr-phone-handset"></i>
            <h6><a href="#">2342544575</a></h6>
            <p>Mon to Fri 9am to 6 pm</p>
          </div>
          <div class="info_item">
            <i class="lnr lnr-envelope"></i>
            <h6><a href="#">admin@bagit.com</a></h6>
            <p>Send us your query anytime!</p>
          </div>
        </div>
      </div>
      <div class="col-lg-9">
        <form
          class="row contact_form"
          action="/contactProcess"
          method="post"
          id="contactForm"
          novalidate="novalidate"
        >
          <div class="col-md-6">
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id="name"
                name="name"
                placeholder="Enter your name"
                onfocus="this.placeholder = ''"
                onblur="this.placeholder = 'Enter your name'"
              />
            </div>
            <div class="form-group">
              <input
                type="email"
                class="form-control"
                id="email"
                name="email"
                placeholder="Enter email address"
                onfocus="this.placeholder = ''"
                onblur="this.placeholder = 'Enter email address'"
              />
            </div>
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id="subject"
                name="subject"
                placeholder="Enter Subject"
                onfocus="this.placeholder = ''"
                onblur="this.placeholder = 'Enter Subject'"
              />
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <textarea
                class="form-control"
                name="message"
                id="message"
                rows="1"
                placeholder="Enter Message"
                onfocus="this.placeholder = ''"
                onblur="this.placeholder = 'Enter Message'"
              ></textarea>
            </div>
          </div>
          <div class="col-md-12 text-right">
            <button type="submit" value="submit" class="primary-btn">
              Send Message
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
<!--================Contact Area =================-->

<!-- start footer Area -->

<!-- End footer Area -->

<!--================Contact Success and Error message Area =================-->
<div id="success" class="modal modal-message fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <i class="fa fa-close"></i>
        </button>
        <h2>Thank you</h2>
        <p>Your message is successfully sent...</p>
      </div>
    </div>
  </div>
</div>

<!-- Modals error -->

<div id="error" class="modal modal-message fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <i class="fa fa-close"></i>
        </button>
        <h2>Sorry !</h2>
        <p>Something went wrong</p>
      </div>
    </div>
  </div>
</div>
<!--================End Contact Success and Error message Area =================-->

<script src="js/vendor/jquery-2.2.4.min.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
  integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
  crossorigin="anonymous"
></script>
<script src="js/vendor/bootstrap.min.js"></script>
<script src="js/jquery.ajaxchimp.min.js"></script>
<script src="js/jquery.nice-select.min.js"></script>
<script src="js/jquery.sticky.js"></script>
<script src="js/nouislider.min.js"></script>
<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/owl.carousel.min.js"></script>
<!--gmaps Js-->

<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE&callback=initializeMap"
  async
  defer
></script>
<script src="js/gmaps.min.js"></script>
<script src="js/main.js"></script>
<script>
  function initializeMap() {
    const mapBox = document.getElementById("mapBox");
    const lat = parseFloat(mapBox.getAttribute("data-lat"));
    const lon = parseFloat(mapBox.getAttribute("data-lon"));
    const zoom = parseInt(mapBox.getAttribute("data-zoom"));
    const info = mapBox.getAttribute("data-info");

    const map = new google.maps.Map(document.getElementById("mapBox"), {
      center: { lat: lat, lng: lon },
      zoom: zoom,
    });

    const marker = new google.maps.Marker({
      position: { lat: lat, lng: lon },
      map: map,
      title: info,
      icon: "https://maps.google.com/mapfiles/kml/pal3/icon21.png",
    });

    const infowindow = new google.maps.InfoWindow({
      content: `<strong>BAG IT</strong><br>Tirur, Malappuram, Kerala, India`,
    });

    marker.addListener("click", () => {
      infowindow.open(map, marker);
    });
  }

  google.maps.event.addDomListener(window, "load", initializeMap);

  document
    .getElementById("contactForm")
    .addEventListener("submit", function (event) {
      event.preventDefault();

      const formData = new FormData(this);

      console.log("Sending request to /contactProcess");

      fetch("/contactProcess", {
        method: "POST",
        body: formData,
      })
        .then((response) => {
          console.log("Response Status:", response.status);
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json();
        })
        .then((data) => {
          console.log("Parsed Response:", data);
          if (data.message === "Message sent successfully") {
            console.log("Showing success modal");
            $("#success").modal("show");
            this.reset();
          } else {
            console.log("Showing error modal due to unexpected response");
            $("#error").modal("show");
          }
        })
        .catch((error) => {
          console.error("Fetch Error:", error);
          $("#error").modal("show");
        });
    });
</script>

<%-include("../../views/partials/user/footer")%>
